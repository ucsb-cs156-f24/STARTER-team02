"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[756],{"./src/stories/components/Restaurants/RestaurantTable.stories.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Empty:()=>Empty,ThreeItemsAdminUser:()=>ThreeItemsAdminUser,ThreeItemsOrdinaryUser:()=>ThreeItemsOrdinaryUser,__namedExportsOrder:()=>__namedExportsOrder,default:()=>__WEBPACK_DEFAULT_EXPORT__});__webpack_require__("./node_modules/react/index.js");var main_components_Restaurants_RestaurantTable__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/main/components/Restaurants/RestaurantTable.js"),fixtures_restaurantFixtures__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./src/fixtures/restaurantFixtures.js"),fixtures_currentUserFixtures__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./src/fixtures/currentUserFixtures.js"),msw__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/msw/lib/core/http.mjs"),msw__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/msw/lib/core/HttpResponse.mjs"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/react/jsx-runtime.js");const __WEBPACK_DEFAULT_EXPORT__={title:"components/Restaurants/RestaurantTable",component:main_components_Restaurants_RestaurantTable__WEBPACK_IMPORTED_MODULE_1__.A},Template=args=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(main_components_Restaurants_RestaurantTable__WEBPACK_IMPORTED_MODULE_1__.A,{...args}),Empty=Template.bind({});Empty.args={restaurants:[],currentUser:fixtures_currentUserFixtures__WEBPACK_IMPORTED_MODULE_3__.Q.userOnly};const ThreeItemsOrdinaryUser=Template.bind({});ThreeItemsOrdinaryUser.args={restaurants:fixtures_restaurantFixtures__WEBPACK_IMPORTED_MODULE_2__.o.threeRestaurants,currentUser:fixtures_currentUserFixtures__WEBPACK_IMPORTED_MODULE_3__.Q.userOnly};const ThreeItemsAdminUser=Template.bind({});ThreeItemsAdminUser.args={restaurants:fixtures_restaurantFixtures__WEBPACK_IMPORTED_MODULE_2__.o.threeRestaurants,currentUser:fixtures_currentUserFixtures__WEBPACK_IMPORTED_MODULE_3__.Q.adminUser},ThreeItemsAdminUser.parameters={msw:[msw__WEBPACK_IMPORTED_MODULE_5__.L.delete("/api/restaurants",(()=>msw__WEBPACK_IMPORTED_MODULE_6__.c.json({message:"Restaurant deleted successfully"},{status:200})))]};const __namedExportsOrder=["Empty","ThreeItemsOrdinaryUser","ThreeItemsAdminUser"];Empty.parameters={...Empty.parameters,docs:{...Empty.parameters?.docs,source:{originalSource:"args => {\n  return <RestaurantTable {...args} />;\n}",...Empty.parameters?.docs?.source}}},ThreeItemsOrdinaryUser.parameters={...ThreeItemsOrdinaryUser.parameters,docs:{...ThreeItemsOrdinaryUser.parameters?.docs,source:{originalSource:"args => {\n  return <RestaurantTable {...args} />;\n}",...ThreeItemsOrdinaryUser.parameters?.docs?.source}}},ThreeItemsAdminUser.parameters={...ThreeItemsAdminUser.parameters,docs:{...ThreeItemsAdminUser.parameters?.docs,source:{originalSource:"args => {\n  return <RestaurantTable {...args} />;\n}",...ThreeItemsAdminUser.parameters?.docs?.source}}}},"./src/fixtures/currentUserFixtures.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Q:()=>currentUserFixtures,x:()=>apiCurrentUserFixtures});const apiCurrentUserFixtures={adminUser:{user:{id:1,email:"phtcon@ucsb.edu",googleSub:"115856948234298493496",pictureUrl:"https://lh3.googleusercontent.com/-bQynVrzVIrU/AAAAAAAAAAI/AAAAAAAAAAA/AMZuucmkGuVsELD1ZeV5iDUAUfe6_K-p8w/s96-c/photo.jpg",fullName:"Phill Conrad",givenName:"Phill",familyName:"Conrad",emailVerified:!0,locale:"en",hostedDomain:"ucsb.edu",admin:!0},roles:[{authority:"ROLE_MEMBER"},{authority:"SCOPE_openid"},{authority:"SCOPE_https://www.googleapis.com/auth/userinfo.profile"},{authority:"SCOPE_https://www.googleapis.com/auth/userinfo.email"},{authority:"ROLE_USER",attributes:{sub:"115856948234298493496",name:"Phill Conrad",given_name:"Phill",family_name:"Conrad",picture:"https://lh3.googleusercontent.com/a/AATXAJyxrU2gDahCiNe4ampVZlv5176Jo0F0PG3KyYgk=s96-c",email:"phtcon@ucsb.edu",email_verified:!0,locale:"en",hd:"ucsb.edu"}},{authority:"ROLE_ADMIN"}]},userOnly:{user:{id:2,email:"pconrad.cis@gmail.com",googleSub:"102656447703889917227",pictureUrl:"https://lh3.googleusercontent.com/a-/AOh14GhpDBUt8eCEqiRT45hrFbcimsX_h1ONn0dc3HV8Bp8=s96-c",fullName:"Phillip Conrad",givenName:"Phillip",familyName:"Conrad",emailVerified:!0,locale:"en",hostedDomain:null,admin:!1},roles:[{authority:"SCOPE_openid"},{authority:"ROLE_USER",attributes:{sub:"102656447703889917227",name:"Phillip Conrad",given_name:"Phillip",family_name:"Conrad",picture:"https://lh3.googleusercontent.com/a-/AOh14GhpDBUt8eCEqiRT45hrFbcimsX_h1ONn0dc3HV8Bp8=s96-c",email:"pconrad.cis@gmail.com",email_verified:!0,locale:"en"}},{authority:"SCOPE_https://www.googleapis.com/auth/userinfo.profile"},{authority:"SCOPE_https://www.googleapis.com/auth/userinfo.email"}]},missingRolesToTestErrorHandling:{user:{id:2,email:"pconrad.cis@gmail.com",googleSub:"102656447703889917227",pictureUrl:"https://lh3.googleusercontent.com/a-/AOh14GhpDBUt8eCEqiRT45hrFbcimsX_h1ONn0dc3HV8Bp8=s96-c",fullName:"Phillip Conrad",givenName:"Phillip",familyName:"Conrad",emailVerified:!0,locale:"en",hostedDomain:null,admin:!1}}},currentUserFixtures={adminUser:{loggedIn:!0,root:{...apiCurrentUserFixtures.adminUser,rolesList:["ROLE_MEMBER","SCOPE_openid","SCOPE_https://www.googleapis.com/auth/userinfo.profile","SCOPE_https://www.googleapis.com/auth/userinfo.email","ROLE_USER","ROLE_ADMIN"]}},userOnly:{loggedIn:!0,root:{...apiCurrentUserFixtures.userOnly,rolesList:["SCOPE_openid","ROLE_USER","SCOPE_https://www.googleapis.com/auth/userinfo.profile","SCOPE_https://www.googleapis.com/auth/userinfo.email"]}},notLoggedIn:{loggedIn:!1,root:{}}}},"./src/fixtures/restaurantFixtures.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{o:()=>restaurantFixtures});const restaurantFixtures={oneRestaurant:[{id:1,name:"The Habit",description:"Burgers and Fries"}],threeRestaurants:[{id:2,name:"Cristino's Bakery",description:"This place is takeout only.  It may look mostly like a bakery with Mexican pastries, but it also has amazing burritos and tacos"},{id:3,name:"Freebirds",description:"Burrito joint, and iconic Isla Vista location"},{id:4,name:"Ca' Dario Cucina Italiana",description:"White tablecloth Italian restaurant, with great pasta and pizza"}]}},"./src/main/components/OurTable.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>OurTable,n:()=>ButtonColumn});var react_table__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react-table/index.js"),react_bootstrap__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/react-bootstrap/esm/Table.js"),react_bootstrap__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/react-bootstrap/esm/Button.js"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/react/jsx-runtime.js"),react__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/react/index.js");function OurTable(_ref){let{columns,data,testid="testid"}=_ref;const{getTableProps,getTableBodyProps,headerGroups,rows,prepareRow}=(0,react_table__WEBPACK_IMPORTED_MODULE_0__.useTable)({columns,data},react_table__WEBPACK_IMPORTED_MODULE_0__.useSortBy);return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsxs)(react_bootstrap__WEBPACK_IMPORTED_MODULE_3__.A,{...getTableProps(),striped:!0,bordered:!0,hover:!0,children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)("thead",{children:headerGroups.map(((headerGroup,i)=>(0,react__WEBPACK_IMPORTED_MODULE_2__.createElement)("tr",{...headerGroup.getHeaderGroupProps(),"data-testid":`${testid}-header-group-${i}`,key:`${testid}-header-group-${i}`},headerGroup.headers.map((column=>(0,react__WEBPACK_IMPORTED_MODULE_2__.createElement)("th",{...column.getHeaderProps(column.getSortByToggleProps()),"data-testid":`${testid}-header-${column.id}`,key:`${testid}-header-${column.id}`},column.render("Header"),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)("span",{"data-testid":`${testid}-header-${column.id}-sort-carets`,children:column.isSorted?column.isSortedDesc?" ðŸ”½":" ðŸ”¼":""})))))))}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)("tbody",{...getTableBodyProps(),children:rows.map((row=>{prepareRow(row);const rowTestId=`${testid}-row-${row.index}`;return(0,react__WEBPACK_IMPORTED_MODULE_2__.createElement)("tr",{...row.getRowProps(),"data-testid":rowTestId,key:rowTestId},row.cells.map(((cell,_index)=>{const testId=`${testid}-cell-row-${cell.row.index}-col-${cell.column.id}`;return(0,react__WEBPACK_IMPORTED_MODULE_2__.createElement)("td",{...cell.getCellProps(),"data-testid":testId,key:testId},cell.render("Cell"))})))}))})]})}function ButtonColumn(label,variant,callback,testid){return{Header:label,id:label,Cell:_ref2=>{let{cell}=_ref2;return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(react_bootstrap__WEBPACK_IMPORTED_MODULE_4__.A,{variant,onClick:()=>callback(cell),"data-testid":`${testid}-cell-row-${cell.row.index}-col-${cell.column.id}-button`,children:label})}}}OurTable.__docgenInfo={description:"",methods:[],displayName:"OurTable",props:{testid:{defaultValue:{value:'"testid"',computed:!1},required:!1}}}},"./src/main/components/Restaurants/RestaurantTable.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>RestaurantTable});__webpack_require__("./node_modules/react/index.js");var OurTable=__webpack_require__("./src/main/components/OurTable.js"),useBackend=__webpack_require__("./src/main/utils/useBackend.js"),react_toastify_esm=__webpack_require__("./node_modules/react-toastify/dist/react-toastify.esm.mjs");function onDeleteSuccess(message){console.log(message),(0,react_toastify_esm.oR)(message)}function cellToAxiosParamsDelete(cell){return{url:"/api/restaurants",method:"DELETE",params:{id:cell.row.values.id}}}var dist=__webpack_require__("./node_modules/react-router/dist/index.js"),utils_currentUser=__webpack_require__("./src/main/utils/currentUser.js"),jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js");function RestaurantTable(_ref){let{restaurants,currentUser,testIdPrefix="RestaurantTable"}=_ref;const navigate=(0,dist.Zp)(),editCallback=cell=>{navigate(`/restaurants/edit/${cell.row.values.id}`)},deleteMutation=(0,useBackend.p)(cellToAxiosParamsDelete,{onSuccess:onDeleteSuccess},["/api/restaurants/all"]),deleteCallback=async cell=>{deleteMutation.mutate(cell)},columns=[{Header:"id",accessor:"id"},{Header:"Name",accessor:"name"},{Header:"Description",accessor:"description"}];return(0,utils_currentUser.hf)(currentUser,"ROLE_ADMIN")&&(columns.push((0,OurTable.n)("Edit","primary",editCallback,testIdPrefix)),columns.push((0,OurTable.n)("Delete","danger",deleteCallback,testIdPrefix))),(0,jsx_runtime.jsx)(OurTable.A,{data:restaurants,columns,testid:testIdPrefix})}RestaurantTable.__docgenInfo={description:"",methods:[],displayName:"RestaurantTable",props:{testIdPrefix:{defaultValue:{value:'"RestaurantTable"',computed:!1},required:!1}}}},"./src/main/utils/currentUser.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Wn:()=>useLogout,hf:()=>hasRole,iZ:()=>useCurrentUser});var react_query__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react-query/es/index.js"),axios__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/axios/lib/axios.js"),react_router_dom__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/react-router/dist/index.js");function useCurrentUser(){let rolesList=["ERROR_GETTING_ROLES"];return(0,react_query__WEBPACK_IMPORTED_MODULE_0__.useQuery)("current user",(async()=>{try{const response=await axios__WEBPACK_IMPORTED_MODULE_1__.A.get("/api/currentUser");try{rolesList=response.data.roles.map((r=>r.authority))}catch(e){console.error("Error getting roles: ",e)}return response.data={...response.data,rolesList},{loggedIn:!0,root:response.data}}catch(e){console.error("Error invoking axios.get: ",e)}}),{initialData:{loggedIn:!1,root:null,initialData:!0}})}function useLogout(){const queryClient=(0,react_query__WEBPACK_IMPORTED_MODULE_0__.useQueryClient)(),navigate=(0,react_router_dom__WEBPACK_IMPORTED_MODULE_2__.Zp)();return(0,react_query__WEBPACK_IMPORTED_MODULE_0__.useMutation)((async()=>{await axios__WEBPACK_IMPORTED_MODULE_1__.A.post("/logout"),await queryClient.resetQueries("current user",{exact:!0}),navigate("/")}))}function hasRole(currentUser,role){var _currentUser$data,_currentUser$data$roo,_currentUser$root,_currentUser$root$rol;return null!=currentUser&&(null!==(_currentUser$data=currentUser.data)&&void 0!==_currentUser$data&&null!==(_currentUser$data$roo=_currentUser$data.root)&&void 0!==_currentUser$data$roo&&_currentUser$data$roo.rolesList?currentUser.data.root.rolesList.includes(role):null===(_currentUser$root=currentUser.root)||void 0===_currentUser$root||null===(_currentUser$root$rol=_currentUser$root.rolesList)||void 0===_currentUser$root$rol?void 0:_currentUser$root$rol.includes(role))}},"./src/main/utils/useBackend.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{O:()=>useBackend,p:()=>useBackendMutation});var react_query__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react-query/es/index.js"),axios__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/axios/lib/axios.js"),react_toastify__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/react-toastify/dist/react-toastify.esm.mjs");function useBackend(queryKey,axiosParameters,initialData){return(0,react_query__WEBPACK_IMPORTED_MODULE_0__.useQuery)(queryKey,(async()=>{try{return(await(0,axios__WEBPACK_IMPORTED_MODULE_2__.A)(axiosParameters)).data}catch(e){const errorMessage=`Error communicating with backend via ${axiosParameters.method} on ${axiosParameters.url}`;throw(0,react_toastify__WEBPACK_IMPORTED_MODULE_1__.oR)(errorMessage),console.error(errorMessage,e),e}}),{initialData})}const wrappedParams=async params=>{try{return await(await(0,axios__WEBPACK_IMPORTED_MODULE_2__.A)(params)).data}catch(rejectedValue){throw error=rejectedValue,console.error("Axios Error:",error),(0,react_toastify__WEBPACK_IMPORTED_MODULE_1__.oR)(`Axios Error: ${error}`),rejectedValue}var error};function useBackendMutation(objectToAxiosParams,useMutationParams){let queryKey=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const queryClient=(0,react_query__WEBPACK_IMPORTED_MODULE_0__.useQueryClient)();return(0,react_query__WEBPACK_IMPORTED_MODULE_0__.useMutation)((object=>wrappedParams(objectToAxiosParams(object))),{onError:data=>{(0,react_toastify__WEBPACK_IMPORTED_MODULE_1__.oR)(`${data}`)},onSettled:()=>{null!==queryKey&&queryClient.invalidateQueries(queryKey)},retry:!1,...useMutationParams})}}}]);