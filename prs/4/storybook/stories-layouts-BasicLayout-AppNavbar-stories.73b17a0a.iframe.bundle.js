"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[659],{"./src/stories/layouts/BasicLayout/AppNavbar.stories.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Default:()=>Default,__namedExportsOrder:()=>__namedExportsOrder,default:()=>__WEBPACK_DEFAULT_EXPORT__});__webpack_require__("./node_modules/react/index.js");var main_components_Nav_AppNavbar__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/main/components/Nav/AppNavbar.js"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/react/jsx-runtime.js");const __WEBPACK_DEFAULT_EXPORT__={title:"layouts/BasicLayout/AppNavbar",component:main_components_Nav_AppNavbar__WEBPACK_IMPORTED_MODULE_1__.A},Default=(()=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(main_components_Nav_AppNavbar__WEBPACK_IMPORTED_MODULE_1__.A,{})).bind({});Default.parameters={...Default.parameters,docs:{...Default.parameters?.docs,source:{originalSource:"() => <AppNavbar />",...Default.parameters?.docs?.source}}};const __namedExportsOrder=["Default"]},"./src/main/components/Nav/AppNavbar.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>AppNavbar});var react_bootstrap__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/react-bootstrap/esm/Navbar.js"),react_bootstrap__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/react-bootstrap/esm/Container.js"),react_bootstrap__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/react-bootstrap/esm/Nav.js"),react_bootstrap__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./node_modules/react-bootstrap/esm/NavDropdown.js"),react_bootstrap__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./node_modules/react-bootstrap/esm/Button.js"),react_router_dom__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/react-router-dom/dist/index.js"),main_utils_currentUser__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./src/main/utils/currentUser.js"),main_components_Nav_AppNavbarLocalhost__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/main/components/Nav/AppNavbarLocalhost.js"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/react/jsx-runtime.js");function AppNavbar(_ref){let{currentUser,systemInfo,doLogout,currentUrl=window.location.href}=_ref;var oauthLogin=(null==systemInfo?void 0:systemInfo.oauthLogin)||"/oauth2/authorization/google";return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.Fragment,{children:[(currentUrl.startsWith("http://localhost:3000")||currentUrl.startsWith("http://127.0.0.1:3000"))&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(main_components_Nav_AppNavbarLocalhost__WEBPACK_IMPORTED_MODULE_1__.A,{url:currentUrl}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(react_bootstrap__WEBPACK_IMPORTED_MODULE_3__.A,{expand:"xl",variant:"dark",bg:"dark",sticky:"top","data-testid":"AppNavbar",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsxs)(react_bootstrap__WEBPACK_IMPORTED_MODULE_4__.A,{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(react_bootstrap__WEBPACK_IMPORTED_MODULE_3__.A.Brand,{as:react_router_dom__WEBPACK_IMPORTED_MODULE_5__.N_,to:"/",children:"Example"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(react_bootstrap__WEBPACK_IMPORTED_MODULE_3__.A.Toggle,{}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsxs)(react_bootstrap__WEBPACK_IMPORTED_MODULE_6__.A,{className:"me-auto",children:[(null==systemInfo?void 0:systemInfo.springH2ConsoleEnabled)&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.Fragment,{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(react_bootstrap__WEBPACK_IMPORTED_MODULE_6__.A.Link,{href:"/h2-console",children:"H2Console"})}),(null==systemInfo?void 0:systemInfo.showSwaggerUILink)&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.Fragment,{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(react_bootstrap__WEBPACK_IMPORTED_MODULE_6__.A.Link,{href:"/swagger-ui/index.html",children:"Swagger"})})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.Fragment,{}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsxs)(react_bootstrap__WEBPACK_IMPORTED_MODULE_3__.A.Collapse,{className:"justify-content-between",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(react_bootstrap__WEBPACK_IMPORTED_MODULE_6__.A,{className:"mr-auto",children:(0,main_utils_currentUser__WEBPACK_IMPORTED_MODULE_0__.hf)(currentUser,"ROLE_ADMIN")&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(react_bootstrap__WEBPACK_IMPORTED_MODULE_7__.A,{title:"Admin",id:"appnavbar-admin-dropdown","data-testid":"appnavbar-admin-dropdown",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(react_bootstrap__WEBPACK_IMPORTED_MODULE_7__.A.Item,{href:"/admin/users",children:"Users"})})}),currentUser&&currentUser.loggedIn&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.Fragment,{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(react_bootstrap__WEBPACK_IMPORTED_MODULE_6__.A.Link,{as:react_router_dom__WEBPACK_IMPORTED_MODULE_5__.N_,to:"/restaurants",children:"Restaurants"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(react_bootstrap__WEBPACK_IMPORTED_MODULE_6__.A.Link,{as:react_router_dom__WEBPACK_IMPORTED_MODULE_5__.N_,to:"/ucsbdates",children:"UCSB Dates"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(react_bootstrap__WEBPACK_IMPORTED_MODULE_6__.A.Link,{as:react_router_dom__WEBPACK_IMPORTED_MODULE_5__.N_,to:"/placeholder",children:"Placeholder"})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(react_bootstrap__WEBPACK_IMPORTED_MODULE_6__.A,{className:"ml-auto",children:currentUser&&currentUser.loggedIn?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.Fragment,{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsxs)(react_bootstrap__WEBPACK_IMPORTED_MODULE_3__.A.Text,{className:"me-3",as:react_router_dom__WEBPACK_IMPORTED_MODULE_5__.N_,to:"/profile",children:["Welcome, ",currentUser.root.user.email]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(react_bootstrap__WEBPACK_IMPORTED_MODULE_8__.A,{onClick:doLogout,children:"Log Out"})]}):(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(react_bootstrap__WEBPACK_IMPORTED_MODULE_8__.A,{href:oauthLogin,children:"Log In"})})]})]})})]})}AppNavbar.__docgenInfo={description:"",methods:[],displayName:"AppNavbar",props:{currentUrl:{defaultValue:{value:"window.location.href",computed:!0},required:!1}}}},"./src/main/components/Nav/AppNavbarLocalhost.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>AppNavbarLocalhost});var react_bootstrap__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/react-bootstrap/esm/Navbar.js"),react_bootstrap__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/react-bootstrap/esm/Container.js"),react_bootstrap__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/react-bootstrap/esm/Nav.js"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/jsx-runtime.js");function AppNavbarLocalhost(_ref){let{url}=_ref;return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.Fragment,{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(react_bootstrap__WEBPACK_IMPORTED_MODULE_1__.A,{expand:"sm",bg:"warning",sticky:"top","data-testid":"AppNavbarLocalhost",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(react_bootstrap__WEBPACK_IMPORTED_MODULE_2__.A,{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(react_bootstrap__WEBPACK_IMPORTED_MODULE_1__.A.Brand,{href:"http://localhost:8080",children:"Warning"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(react_bootstrap__WEBPACK_IMPORTED_MODULE_1__.A.Toggle,{}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(react_bootstrap__WEBPACK_IMPORTED_MODULE_1__.A.Collapse,{className:"justify-content-between",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(react_bootstrap__WEBPACK_IMPORTED_MODULE_3__.A,{className:"mr-auto text-center",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(react_bootstrap__WEBPACK_IMPORTED_MODULE_3__.A.Item,{className:"text-center",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("p",{children:["Running on ",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("code",{children:url})," with no backend.",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("br",{}),"You probably want ",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("a",{href:"http://localhost:8080",children:"http://localhost:8080"})," instead."]})})})})]})})})}AppNavbarLocalhost.__docgenInfo={description:"",methods:[],displayName:"AppNavbarLocalhost"}},"./src/main/utils/currentUser.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Wn:()=>useLogout,hf:()=>hasRole,iZ:()=>useCurrentUser});var react_query__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react-query/es/index.js"),axios__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/axios/index.js"),axios__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(axios__WEBPACK_IMPORTED_MODULE_1__),react_router_dom__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/react-router/dist/index.js");function useCurrentUser(){let rolesList=["ERROR_GETTING_ROLES"];return(0,react_query__WEBPACK_IMPORTED_MODULE_0__.useQuery)("current user",(async()=>{try{const response=await axios__WEBPACK_IMPORTED_MODULE_1___default().get("/api/currentUser");try{rolesList=response.data.roles.map((r=>r.authority))}catch(e){console.error("Error getting roles: ",e)}return response.data={...response.data,rolesList},{loggedIn:!0,root:response.data}}catch(e){return console.error("Error invoking axios.get: ",e),{loggedIn:!1,root:null}}}),{initialData:{loggedIn:!1,root:null,initialData:!0}})}function useLogout(){const queryClient=(0,react_query__WEBPACK_IMPORTED_MODULE_0__.useQueryClient)(),navigate=(0,react_router_dom__WEBPACK_IMPORTED_MODULE_2__.Zp)();return(0,react_query__WEBPACK_IMPORTED_MODULE_0__.useMutation)((async()=>{await axios__WEBPACK_IMPORTED_MODULE_1___default().post("/logout"),await queryClient.resetQueries("current user",{exact:!0}),navigate("/")}))}function hasRole(currentUser,role){var _currentUser$root,_currentUser$root$rol;return null!=currentUser&&("data"in currentUser&&"root"in currentUser.data&&null!=currentUser.data.root&&"rolesList"in currentUser.data.root?currentUser.data.root.rolesList.includes(role):null===(_currentUser$root=currentUser.root)||void 0===_currentUser$root||null===(_currentUser$root$rol=_currentUser$root.rolesList)||void 0===_currentUser$root$rol?void 0:_currentUser$root$rol.includes(role))}}}]);